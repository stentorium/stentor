"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[19454],{4503:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>m,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var r=t(68102),a=(t(63696),t(19916));const s={id:"custom-channels",title:"Creating Custom Channels"},l="Creating Custom Channels",o={unversionedId:"custom-channels",id:"custom-channels",title:"Creating Custom Channels",description:"Channels in Stentor are platform abstractions that translate external platform requests and responses into Stentor's internal format. This guide explains how to create custom channels to integrate new platforms.",source:"@site/../docs/CustomChannels.md",sourceDirName:".",slug:"/custom-channels",permalink:"/stentor/docs/custom-channels",draft:!1,editUrl:"https://github.com/stentorium/stentor/tree/master/docs/../docs/CustomChannels.md",tags:[],version:"current",frontMatter:{id:"custom-channels",title:"Creating Custom Channels"},sidebar:"tutorialSidebar",previous:{title:"Handler System",permalink:"/stentor/docs/handlers"},next:{title:"Recommended Development Environment",permalink:"/stentor/docs/recommended-dev-environment"}},i={},p=[{value:"Overview",id:"overview",level:2},{value:"Channel Interface",id:"channel-interface",level:2},{value:"Required Properties",id:"required-properties",level:3},{value:"Optional Properties",id:"optional-properties",level:3},{value:"Implementation Steps",id:"implementation-steps",level:2},{value:"1. Create Request Translator",id:"1-create-request-translator",level:3},{value:"2. Create Response Translator",id:"2-create-response-translator",level:3},{value:"3. Implement Capabilities Function",id:"3-implement-capabilities-function",level:3},{value:"4. Create Channel Object",id:"4-create-channel-object",level:3},{value:"5. Register Channel",id:"5-register-channel",level:3},{value:"Example: Test Channel",id:"example-test-channel",level:2},{value:"Channel Selection",id:"channel-selection",level:2},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Channel Hooks",id:"channel-hooks",level:3},{value:"NLU Integration",id:"nlu-integration",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Reference Files",id:"reference-files",level:2},{value:"Next Steps",id:"next-steps",level:2}],c={toc:p},u="wrapper";function m({components:e,...n}){return(0,a.yg)(u,(0,r.A)({},c,n,{components:e,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"creating-custom-channels"},"Creating Custom Channels"),(0,a.yg)("p",null,"Channels in Stentor are platform abstractions that translate external platform requests and responses into Stentor's internal format. This guide explains how to create custom channels to integrate new platforms."),(0,a.yg)("h2",{id:"overview"},"Overview"),(0,a.yg)("p",null,"Each channel bridges communication between external platforms (like Alexa, Google Assistant, or custom platforms) and Stentor's core runtime. A channel is responsible for:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Detecting if an incoming request belongs to its platform"),(0,a.yg)("li",{parentName:"ul"},"Translating platform-specific requests to Stentor's Request format"),(0,a.yg)("li",{parentName:"ul"},"Converting Stentor's Response back to the platform's format"),(0,a.yg)("li",{parentName:"ul"},"Reporting device capabilities")),(0,a.yg)("h2",{id:"channel-interface"},"Channel Interface"),(0,a.yg)("p",null,"A channel implements the ",(0,a.yg)("inlineCode",{parentName:"p"},"Channel")," interface with the following required properties:"),(0,a.yg)("h3",{id:"required-properties"},"Required Properties"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"name")),' (string) - Alphanumeric identifier for the channel (e.g., "actions-on-google", "alexa")'),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"test(body: object): boolean"))," - Function to detect if incoming request is for this channel"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"request"))," - A Translator instance that converts incoming requests to Stentor's Request format"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"response"))," - A Translator instance that converts Stentor's Response to the platform's format"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"capabilities(body: object): Device"))," - Function returning device capabilities from the request")),(0,a.yg)("h3",{id:"optional-properties"},"Optional Properties"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"nlu?: NLUService"))," - Optional NLU service for the channel"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"hooks?: ChannelHooks"))," - Optional runtime hooks (preExecution, postRequestTranslation, preResponseTranslation)"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"handlerHook?"))," - Optional Lambda event interceptor for special handling"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},(0,a.yg)("inlineCode",{parentName:"strong"},"builder?"))," (deprecated) - Deprecated response builder pattern")),(0,a.yg)("h2",{id:"implementation-steps"},"Implementation Steps"),(0,a.yg)("h3",{id:"1-create-request-translator"},"1. Create Request Translator"),(0,a.yg)("p",null,"Create a request translator that extends the Translator pattern:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Translator } from "@xapp/patterns";\nimport { Request } from "stentor-models";\n\nclass MyRequestTranslator extends Translator<object, Request> {\n  translate(body: object): Request {\n    // Convert platform request to Stentor Request format\n    return {\n      type: "INTENT_REQUEST",\n      intentId: extractIntentId(body),\n      sessionId: extractSessionId(body),\n      userId: extractUserId(body),\n      // ... other Request properties\n    };\n  }\n}\n')),(0,a.yg)("h3",{id:"2-create-response-translator"},"2. Create Response Translator"),(0,a.yg)("p",null,"Create a response translator for converting Stentor responses:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Translator } from "@xapp/patterns";\nimport { Response } from "stentor-models";\n\nclass MyResponseTranslator extends Translator<Response, object> {\n  translate(response: Response): object {\n    // Convert Stentor Response to platform format\n    return {\n      // Platform-specific response structure\n      speech: response.outputSpeech?.ssml,\n      displayText: response.outputSpeech?.displayText,\n      // ... other platform properties\n    };\n  }\n}\n')),(0,a.yg)("h3",{id:"3-implement-capabilities-function"},"3. Implement Capabilities Function"),(0,a.yg)("p",null,"The capabilities function extracts device information from the request:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'function getCapabilities(body: object): Device {\n  return {\n    canSpeak: true,\n    canPlayAudio: checkAudioSupport(body),\n    hasScreen: checkScreenSupport(body),\n    hasWebBrowser: false,\n    channel: "my-platform",\n    // ... other device capabilities\n  };\n}\n')),(0,a.yg)("h3",{id:"4-create-channel-object"},"4. Create Channel Object"),(0,a.yg)("p",null,"Combine all components into a Channel object:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Channel } from "stentor-models";\n\nexport function MyCustomChannel(): Channel {\n  return {\n    name: "my-platform",\n\n    test(body): boolean {\n      // Detect if request is for this channel\n      // Check for platform-specific markers\n      return body?.platform === "my-platform" ||\n             body?.version?.startsWith("my-platform-");\n    },\n\n    request: new MyRequestTranslator(),\n    response: new MyResponseTranslator(),\n\n    capabilities(body): Device {\n      return {\n        canSpeak: true,\n        canPlayAudio: true,\n        hasScreen: body?.device?.screenAvailable || false,\n        channel: "my-platform"\n      };\n    }\n  };\n}\n')),(0,a.yg)("h3",{id:"5-register-channel"},"5. Register Channel"),(0,a.yg)("p",null,"Register the channel with your Assistant instance:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'import { Assistant } from "stentor";\nimport { MyCustomChannel } from "./MyCustomChannel";\n\nconst assistant = new Assistant()\n  .withChannels([\n    MyCustomChannel()\n  ])\n  .withHandlers([\n    // Your handlers\n  ]);\n')),(0,a.yg)("h2",{id:"example-test-channel"},"Example: Test Channel"),(0,a.yg)("p",null,"Here's a simplified example from the Stentor test suite:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'export function TestChannel(): Channel {\n  return {\n    name: "test-channel",\n\n    test(body): boolean {\n      return body?.channel === "test-channel";\n    },\n\n    request: new TestRequestTranslator(),\n    response: new TestResponseTranslator(),\n\n    capabilities(body): Device {\n      return {\n        canSpeak: true,\n        canPlayAudio: false,\n        hasScreen: false,\n        channel: "test-channel"\n      };\n    }\n  };\n}\n')),(0,a.yg)("h2",{id:"channel-selection"},"Channel Selection"),(0,a.yg)("p",null,"At runtime, Stentor:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Receives an incoming request"),(0,a.yg)("li",{parentName:"ol"},"Tests each registered channel using its ",(0,a.yg)("inlineCode",{parentName:"li"},"test()")," function"),(0,a.yg)("li",{parentName:"ol"},"Selects the first channel that returns ",(0,a.yg)("inlineCode",{parentName:"li"},"true")),(0,a.yg)("li",{parentName:"ol"},"Uses that channel's translators for the entire request/response cycle")),(0,a.yg)("h2",{id:"advanced-features"},"Advanced Features"),(0,a.yg)("h3",{id:"channel-hooks"},"Channel Hooks"),(0,a.yg)("p",null,"Channels can define hooks to intercept and modify behavior:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},'{\n  hooks: {\n    preExecution: async (request, context) => {\n      // Run before handler execution\n      console.log("Pre-execution hook");\n    },\n    postRequestTranslation: async (request, body, context) => {\n      // Run after request translation\n      return request; // Return modified request\n    },\n    preResponseTranslation: async (response, context) => {\n      // Run before response translation\n      return response; // Return modified response\n    }\n  }\n}\n')),(0,a.yg)("h3",{id:"nlu-integration"},"NLU Integration"),(0,a.yg)("p",null,"Channels can provide their own NLU service:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-typescript"},"{\n  nlu: {\n    query: async (text: string) => {\n      // Call your NLU service\n      const result = await myNLU.query(text);\n      return {\n        intentId: result.intent,\n        slots: result.entities\n      };\n    }\n  }\n}\n")),(0,a.yg)("h2",{id:"best-practices"},"Best Practices"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Unique Identifiers"),": Use descriptive, unique channel names"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Robust Detection"),": Make ",(0,a.yg)("inlineCode",{parentName:"li"},"test()")," specific enough to avoid false positives"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Complete Translation"),": Ensure all Request/Response properties are mapped"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Error Handling"),": Handle malformed requests gracefully"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Device Capabilities"),": Accurately report what the device can do"),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Testing"),": Write comprehensive tests for your translators")),(0,a.yg)("h2",{id:"reference-files"},"Reference Files"),(0,a.yg)("p",null,"View the source code on GitHub:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Channel Interface: ",(0,a.yg)("inlineCode",{parentName:"li"},"packages/stentor-models/src/Channel/Channel.ts")),(0,a.yg)("li",{parentName:"ul"},"Test Channel Example: ",(0,a.yg)("inlineCode",{parentName:"li"},"packages/stentor/src/__test__/TestChannel.ts")),(0,a.yg)("li",{parentName:"ul"},"Base Channel Implementation: ",(0,a.yg)("inlineCode",{parentName:"li"},"packages/stentor-channel/src/Channel.ts"))),(0,a.yg)("h2",{id:"next-steps"},"Next Steps"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Learn about ",(0,a.yg)("a",{parentName:"li",href:"/stentor/docs/handlers"},"Handlers")," to process requests"),(0,a.yg)("li",{parentName:"ul"},"Explore the ",(0,a.yg)("a",{parentName:"li",href:"/stentor/docs/getting-started"},"Getting Started")," guide")))}m.isMDXComponent=!0},19916:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>y});var r=t(63696);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach(function(n){a(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=r.createContext({}),p=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=p(e.components);return r.createElement(i.Provider,{value:n},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef(function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(t),g=a,y=u["".concat(i,".").concat(g)]||u[g]||m[g]||s;return t?r.createElement(y,l(l({ref:n},c),{},{components:t})):r.createElement(y,l({ref:n},c))});function y(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,l=new Array(s);l[0]=g;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o[u]="string"==typeof e?e:a,l[1]=o;for(var p=2;p<s;p++)l[p]=t[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"}}]);